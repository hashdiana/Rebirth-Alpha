//Deobfuscated with https://github.com/SimplyProgrammer/Minecraft-Deobfuscator3000 using mappings "G:\PortableSoft\JBY\MC_Deobf3000\1.12-MCP-Mappings"!

package me.rebirthclient.mod.modules.impl.exploit;

import me.rebirthclient.api.events.impl.PacketEvent;
import me.rebirthclient.api.managers.impl.SneakManager;
import me.rebirthclient.api.util.BlockUtil;
import me.rebirthclient.mod.modules.Category;
import me.rebirthclient.mod.modules.Module;
import net.minecraft.block.Block;
import net.minecraft.init.Blocks;
import net.minecraft.item.ItemAppleGold;
import net.minecraft.item.ItemBow;
import net.minecraft.item.ItemChorusFruit;
import net.minecraft.item.ItemEnderPearl;
import net.minecraft.item.ItemExpBottle;
import net.minecraft.network.play.client.CPacketPlayerTryUseItemOnBlock;
import net.minecraft.util.math.BlockPos;
import net.minecraft.util.math.RayTraceResult;
import net.minecraft.util.math.RayTraceResult.Type;
import net.minecraftforge.event.entity.player.PlayerInteractEvent.RightClickBlock;
import net.minecraftforge.fml.common.eventhandler.SubscribeEvent;

public class NoInteract extends Module {
   public NoInteract() {
      super("NoInteract", "Allows you to eat and throw exp when looking at tile entities", Category.EXPLOIT);
   }

   @SubscribeEvent
   public void onPacketSend(PacketEvent.Send event) {
      if (!fullNullCheck()) {
         RayTraceResult ray = mc.objectMouseOver;
         if (ray != null && ray.typeOfHit == Type.BLOCK && event.getPacket() instanceof CPacketPlayerTryUseItemOnBlock) {
            BlockPos pos = ray.getBlockPos();
            Block block = BlockUtil.getBlock(pos);
            if ((block == Blocks.ANVIL || block == Blocks.ENDER_CHEST) && this.check()) {
               event.setCanceled(true);
            }
         }
      }
   }

   @SubscribeEvent
   public void onInteract(RightClickBlock event) {
      if (!nullCheck()) {
         Block block = BlockUtil.getBlock(event.getPos());
         if ((block == Blocks.ANVIL || block == Blocks.ENDER_CHEST) && this.check()) {
            event.setCanceled(true);
         }
      }
   }

   private boolean check() {
      return !SneakManager.isSneaking
         && mc.gameSettings.keyBindUseItem.isKeyDown()
         && (
            mc.player.getHeldItemMainhand().getItem() instanceof ItemExpBottle
               || mc.player.getHeldItemMainhand().getItem() instanceof ItemEnderPearl
               || mc.player.getHeldItemMainhand().getItem() instanceof ItemAppleGold
               || mc.player.getHeldItemMainhand().getItem() instanceof ItemBow
               || mc.player.getHeldItemMainhand().getItem() instanceof ItemChorusFruit
         );
   }
}
