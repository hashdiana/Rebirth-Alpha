//Deobfuscated with https://github.com/SimplyProgrammer/Minecraft-Deobfuscator3000 using mappings "G:\PortableSoft\JBY\MC_Deobf3000\1.12-MCP-Mappings"!

package me.rebirthclient.mod.modules.impl.exploit;

import me.rebirthclient.api.managers.Managers;
import me.rebirthclient.api.util.InventoryUtil;
import me.rebirthclient.mod.modules.Category;
import me.rebirthclient.mod.modules.Module;
import net.minecraft.block.BlockEnderChest;
import net.minecraft.block.BlockObsidian;
import net.minecraft.item.ItemEnderPearl;
import net.minecraft.network.play.client.CPacketHeldItemChange;
import net.minecraft.network.play.client.CPacketPlayerTryUseItem;
import net.minecraft.util.EnumHand;
import net.minecraft.util.math.BlockPos;

public class PearlSpoof extends Module {
   public PearlSpoof() {
      super("PearlSpoof", "Pearl phase using packet spam", Category.EXPLOIT);
   }

   @Override
   public void onEnable() {
      if (!fullNullCheck()) {
         int oldSlot = mc.player.inventory.currentItem;
         int obbySlot = InventoryUtil.findHotbarClass(BlockObsidian.class);
         int echestSlot = InventoryUtil.findHotbarClass(BlockEnderChest.class);
         int pearlSlot = InventoryUtil.findHotbarClass(ItemEnderPearl.class);
         if (pearlSlot != -1) {
            mc.player.connection.sendPacket(new CPacketHeldItemChange(obbySlot == -1 ? echestSlot : obbySlot));
            Managers.INTERACTIONS.placeBlock(this.getRandomBlock(), false, true, false);
            mc.player.connection.sendPacket(new CPacketHeldItemChange(pearlSlot == 1 ? pearlSlot + 1 : pearlSlot - 1));
            mc.player.connection.sendPacket(new CPacketHeldItemChange(pearlSlot));
            mc.player.connection.sendPacket(new CPacketPlayerTryUseItem(EnumHand.MAIN_HAND));
            mc.player.connection.sendPacket(new CPacketHeldItemChange(oldSlot));
         }

         this.disable();
      }
   }

   private BlockPos getRandomBlock() {
      return new BlockPos(
         mc.player.posX + Math.random() * 4.0,
         mc.player.posY + Math.random() * 3.0,
         mc.player.posZ + Math.random() * 4.0
      );
   }
}
